
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

    <title>Local thickness &#8212; PoreSpy  documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.f6b7ca918bee2f46fd9abac01cfb07d5.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1e043a052b0af929e4d8.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Porosimetry" href="porosimetry.html" />
    <link rel="prev" title="hold_peaks" href="hold_peaks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">


    
      
      <a class="navbar-brand" href="https://www.porespy.org">
        <img src="../../_static/porespy_logo.png" class="logo" alt="logo">
      </a>
      
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    
    <div id="navbar-menu" class=" collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../modules/index.html">
  Module and Function Reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../examples.html">
  Examples
 </a>
</li>

        
        <li class="nav-item">
            <a class="nav-link nav-external" href="https://github.com/PMEAL/porespy/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link nav-external" href="https://github.com/PMEAL/porespy/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
        </li>
        
      </ul>

      <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PMEAL/porespy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://porespy.substack.com/" rel="noopener" target="_blank" title="Substack">
            <span><i class="fas fa-envelope-square"></i></span>
            <label class="sr-only">Substack</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/porespy" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/RSA.html">
   Generating Polydisperse Spheres using RSA
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/bundle_of_tubes.html">
   bundle_of_tubes
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/cylinders.html">
   Generating fibrous mats
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/insert_shape.html">
   insert_shape
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/lattice_spheres.html">
   lattice_spheres
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/line_segment.html">
   line_segment
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/overlapping_spheres.html">
   overlapping_spheres
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/perlin_noise.html">
   perlin_noise
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/polydisperse_spheres.html">
   polydisperse _spheres
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../generators/voronoi_edges.html">
   voronoi_edges
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="adding_chords.html">
   Applying chords to 2D and 3D images
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="apply_chords.html">
   apply_chords
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="apply_chords_3D.html">
   apply_chords_3D
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="apply_padded.html">
   apply_padded
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="chunked_func.html">
   chunked_func
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="distance_transform_lin.html">
   distance_transform_lin
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="fill_blind_pores.html">
   fill_blind_pores
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="find_disconnected_voxels.html">
   find_disconnected_voxels
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="find_dt_artifacts.html">
   find_dt_artifacts
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="find_peaks.html">
   find_peaks
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="flood.html">
   flood
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="hold_peaks.html">
   hold_peaks
  </a>
 </li>
 <li class="toctree-l2 current active">
  <a class="current reference internal" href="#">
   Local thickness
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="porosimetry.html">
   Porosimetry
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="prune_branches.html">
   prune_branches
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="reduce_peaks.html">
   reduce_peaks
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="region_size.html">
   region_size
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="snow_partitioning.html">
   SNOW partitioning
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="snow_partitioning_n.html">
   snow_partitioning_n
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="snow_partitioning_parallel.html">
   SNOW partitioning parallel
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_disconnected_blobs.html">
   trim_disconnected_blobs
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_extrema.html">
   trim_extrema
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_floating_solid.html">
   trim_nearby_peaks
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_nearby_peaks.html">
   trim_floating_solid
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_nonpercolating_paths.html">
   trim_nonpercolating_paths
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_saddle_points.html">
   trim_saddle_points
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="trim_small_clusters.html">
   trim_small_clusters
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../networks/adding_boundary_pores.html">
   Adding Boundary Pores
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../networks/snow_advanced.html">
   SNOW network extraction (advanced)
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../networks/snow_basic.html">
   SNOW network extraction
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/chord_counts.html">
   chord_counts
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/chord_length_distribution.html">
   chord_length_distribution
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/linear_density.html">
   linear_density
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/mesh_surface_area.html">
   mesh_surface_area
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/phase_fraction.html">
   phase_fraction
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/pore_size_distribution.html">
   pore_size_distribution
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/porosity.html">
   porosity
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/porosity_profiles.html">
   Obtaining the porosity profile along each principle axis
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/radial_density.html">
   radial_density
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/region_interface_areas.html">
   region_interface_areas
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/region_surface_areas.html">
   region_surface_areas
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/regionprops_3d.html">
   Using regionprops_3d to analyze properties of each pore
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/representative_elementary_volume.html">
   representative_elementary_volume
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/two_point_correlation.html">
   Two Point Correlation Function
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/two_point_correlation_bf.html">
   two_point_correlation_bf
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../metrics/two_point_correlation_fft.html">
   two_point_correlation_fft
  </a>
 </li>
</ul>
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Generate-Test-Image">
   Generate Test Image
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Apply-Local-Thickness-Filter">
   Apply Local Thickness Filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Extracting-PSD-as-a-Histogram">
   Extracting PSD as a Histogram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#PoreSpy-Implementation">
   PoreSpy Implementation
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 0;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Local-thickness">
<h1>Local thickness<a class="headerlink" href="#Local-thickness" title="Permalink to this headline">¶</a></h1>
<p>This example explains how to use the <code class="docutils literal notranslate"><span class="pre">local_thickness</span></code> filter to get information about the pore size distribution from an image. The local thickness is probably the closest you can get to an actual pore size distribution. Unlike porosimetry experiments or simulations it is unaffected by artifacts such as edge effects. The implementation in PoreSpy is slightly different than the common approach done in ImageJ, as will be explained below.</p>
<p>These notebooks were generated with a specific version of Python, PoreSpy, Numpy, etc. For reference to future viewers, the version information is given below. This notebook may or may not work with later versions, but we can assert it works with the version listed below:</p>
<p>Import the needed packages from the Scipy stack:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import numpy as np
import porespy as ps
import scipy.ndimage as spim
import matplotlib.pyplot as plt
ps.visualization.set_mpl_style()
</pre></div>
</div>
</div>
<section id="Generate-Test-Image">
<h2>Generate Test Image<a class="headerlink" href="#Generate-Test-Image" title="Permalink to this headline">¶</a></h2>
<p>Start by generating an image. We’ll use the RSA generator for fun:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>im = np.zeros([300, 300])
im = ps.generators.RSA(im, radius=20, volume_fraction=0.2)
im = ps.generators.RSA(im, radius=15, volume_fraction=0.4)
im = ps.generators.RSA(im, radius=10, volume_fraction=0.6)
im = im == 0
fig, ax = plt.subplots()
ax.imshow(im);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_filters_local_thickness_5_0.svg" src="../../_images/examples_filters_local_thickness_5_0.svg" /></div>
</div>
</section>
<section id="Apply-Local-Thickness-Filter">
<h2>Apply Local Thickness Filter<a class="headerlink" href="#Apply-Local-Thickness-Filter" title="Permalink to this headline">¶</a></h2>
<p>The local thickness filter is called by simply passing in the image. Like all filters in PoreSpy it is applied to the foreground, indicated by 1’s or <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>thk = ps.filters.local_thickness(im, mode=&#39;dt&#39;)
fig, ax = plt.subplots()
ax.imshow(thk, cmap=plt.cm.jet);
import tqdm.notebook as tqdm
from time import sleep
for i in tqdm.tqdm(range(10)):
    sleep(0.1)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7e1d061683c3430eaf4e17a423e0537b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_filters_local_thickness_7_2.svg" src="../../_images/examples_filters_local_thickness_7_2.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from tqdm.notebook import tqdm, tqdm_notebook
for i in tqdm_notebook(range(10)):
    sleep(0.1)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "85aa5837630141e0a2aee14ded2f6ac1", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="Extracting-PSD-as-a-Histogram">
<h2>Extracting PSD as a Histogram<a class="headerlink" href="#Extracting-PSD-as-a-Histogram" title="Permalink to this headline">¶</a></h2>
<p>Obtaining pore size distribution information from this image requires obtaining a histogram of voxel values. A function in the <code class="docutils literal notranslate"><span class="pre">metrics</span></code> module does this for us:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>psd = ps.metrics.pore_size_distribution(im=thk)
</pre></div>
</div>
</div>
<p>The result returned into <code class="docutils literal notranslate"><span class="pre">psd</span></code> is a “named-tuple”, which is a list of arrays that can be accessed by location (i.e. <code class="docutils literal notranslate"><span class="pre">psd[0]</span></code>), but has the added benefit of accessing arrays by name so you know what you’re getting. You can print a list of available arrays as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>print(psd._fields)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;LogR&#39;, &#39;pdf&#39;, &#39;cdf&#39;, &#39;satn&#39;, &#39;bin_centers&#39;, &#39;bin_edges&#39;, &#39;bin_widths&#39;)
</pre></div></div>
</div>
<p>Let’s plot a pore-size distribution histogram:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>fig, ax = plt.subplots(figsize=(5, 4))
ax.set_xlabel(&#39;log(Pore Radius) [voxels]&#39;)
ax.set_ylabel(&#39;Normalized Volume Fraction&#39;)
ax.bar(x=psd.LogR, height=psd.pdf, width=psd.bin_widths, edgecolor=&#39;k&#39;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_filters_local_thickness_14_0.svg" src="../../_images/examples_filters_local_thickness_14_0.svg" /></div>
</div>
</section>
<section id="PoreSpy-Implementation">
<h2>PoreSpy Implementation<a class="headerlink" href="#PoreSpy-Implementation" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">local_thickness</span></code> filter in PoreSpy is implemented differently that the <em>normal</em> approach such as the ImageJ plugin, though the end result is comparible though not identical.</p>
<p>In our approach, we use a form of image dilation and erosion. We start with a large spherical structuring element, and note all the places where this fits in the pore space. This gives a result like that below for a structuring element of radius R=10:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>R = 10
strel = ps.tools.ps_disk(R)
im_temp = spim.binary_opening(im, structure=strel)
fig, ax = plt.subplots()
ax.imshow(im_temp*2.0 + ~im);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_filters_local_thickness_16_0.svg" src="../../_images/examples_filters_local_thickness_16_0.svg" /></div>
</div>
<p>The key is to make a <em>master</em> array containing the numerical value of the largest sphere that covers each voxel. We’ll initialize a new array with the current locations where R=10 fits:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>im_result = im_temp*R
</pre></div>
</div>
</div>
<p>Now this is repeated for a range of decreasing structuring element sizes. For illustration, do R = 8:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>R = 8
strel = ps.tools.ps_disk(R)
im_temp = spim.binary_opening(im, structure=strel)
</pre></div>
</div>
</div>
<p>This new image must be added to the <code class="docutils literal notranslate"><span class="pre">im_result</span></code> array, but only in places that were not filled at any larger radius. This is done using boolean logic as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>im_result[(im_result == 0)*im_temp] = R
</pre></div>
</div>
</div>
<p>There are now 2 values in the <code class="docutils literal notranslate"><span class="pre">im_results</span></code> array indicating the locations where the structuring element of size 10 fits, and where size 8 fit on the subsequent step:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>fig, ax = plt.subplots()
ax.imshow(im_result + ~im);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_filters_local_thickness_24_0.svg" src="../../_images/examples_filters_local_thickness_24_0.svg" /></div>
</div>
<p>The procedure is then repeated for smaller structuring elements down to R = 1. It’s possible to specify which sizes are used, but by default all integers between <span class="math notranslate nohighlight">\(R_{max}\)</span> and 1. This yields the image showed above:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>fig, ax = plt.subplots()
ax.imshow(thk, cmap=plt.cm.jet);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_filters_local_thickness_26_0.svg" src="../../_images/examples_filters_local_thickness_26_0.svg" /></div>
</div>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.1e043a052b0af929e4d8.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2021 PoreSpy Team.<br/>
    </p>
  </div>
</footer>
  </body>
</html>