
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image-based invasion percoalation &#8212; PoreSpy  documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="apply_chords" href="../howtos/apply_chords.html" />
    <link rel="prev" title="SNOW partitioning parallel" href="snow_partitioning_parallel.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://www.porespy.org">
  <img src="../../../_static/porespy_logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../modules/index.html">
  Module and Function Reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../../examples.html">
  Examples
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/porespy/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/porespy/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PMEAL/porespy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://porespy.substack.com/" rel="noopener" target="_blank" title="Substack">
            <span><i class="fas fa-envelope-square"></i></span>
            <label class="sr-only">Substack</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/porespy" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/tutorials/RSA.html">
   Generating polydisperse spheres using RSA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/tutorials/cylinders.html">
   Generating fibrous mats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/tutorials/making_blobs.html">
   Making blobs
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/bundle_of_tubes.html">
   bundle_of_tubes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/fractal_noise.html">
   fractal_noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/insert_shape.html">
   insert_shape
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/lattice_spheres.html">
   lattice_spheres
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/line_segment.html">
   line_segment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/overlapping_spheres.html">
   overlapping_spheres
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/polydisperse_spheres.html">
   polydisperse _spheres
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../generators/howtos/voronoi_edges.html">
   voronoi_edges
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="adding_chords.html">
   Applying chords to 2D and 3D images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="local_thickness.html">
   Local thickness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="snow_partitioning.html">
   SNOW partitioning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="snow_partitioning_parallel.html">
   SNOW partitioning parallel
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Image-based invasion percoalation
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/apply_chords.html">
   apply_chords
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/apply_chords_3D.html">
   apply_chords_3D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/apply_padded.html">
   apply_padded
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/chunked_func.html">
   chunked_func
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/distance_transform_lin.html">
   distance_transform_lin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/fill_blind_pores.html">
   fill_blind_pores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/find_disconnected_voxels.html">
   find_disconnected_voxels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/find_dt_artifacts.html">
   find_dt_artifacts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/find_peaks.html">
   find_peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/flood.html">
   flood
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/hold_peaks.html">
   hold_peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/prune_branches.html">
   prune_branches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/reduce_peaks.html">
   reduce_peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/region_size.html">
   region_size
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/snow_partitioning_n.html">
   snow_partitioning_n
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/snow_partitioning_parallel.html">
   snow_partitioning_parallel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_disconnected_blobs.html">
   trim_disconnected_blobs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_extrema.html">
   trim_extrema
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_floating_solid.html">
   trim_floating_solid
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_nearby_peaks.html">
   trim_nearby_peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_nonpercolating_paths.html">
   trim_nonpercolating_paths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_saddle_points.html">
   trim_saddle_points
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howtos/trim_small_clusters.html">
   trim_small_clusters
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/tutorials/computing_fractal_dim.html">
   Measuring fractal dimension by box-counting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/tutorials/lineal_path_function.html">
   The lineal path function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/tutorials/porosity_profiles.html">
   Obtaining the porosity profile along each principle axis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/tutorials/regionprops_3d.html">
   Using regionprops_3d to analyze properties of each pore
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/tutorials/two_point_correlation.html">
   Two point correlation function
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/chord_counts.html">
   chord_counts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/chord_length_distribution.html">
   chord_length_distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/geometrical_tortuosity.html">
   geometrical_tortuosity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/linear_density.html">
   lineal_path_distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/mesh_surface_area.html">
   mesh_surface_area
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/phase_fraction.html">
   phase_fraction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/pore_size_distribution.html">
   pore_size_distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/porosity.html">
   porosity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/radial_density.html">
   radial_density_distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/region_interface_areas.html">
   region_interface_areas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/region_surface_areas.html">
   region_surface_areas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/representative_elementary_volume.html">
   representative_elementary_volume
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/two_point_correlation_bf.html">
   two_point_correlation_bf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../metrics/howtos/two_point_correlation_fft.html">
   two_point_correlation_fft
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../networks/tutorials/adding_boundary_pores.html">
   Adding boundary pores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../networks/tutorials/snow_advanced.html">
   SNOW network extraction (advanced)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../networks/tutorials/snow_basic.html">
   SNOW network extraction
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../networks/howtos/map_to_regions.html">
   map_to_regions maps
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/align_image_with_openpnm.html">
   align_image_with_openpnm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/bbox_to_slices.html">
   bbox_to_slices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/extract_cylinder.html">
   extract_cylinder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/extract_regions.html">
   extract_regions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/extract_subsection.html">
   extract_subsection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/get_border.html">
   get_border
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/get_planes.html">
   get_planes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/insert_cylinder.html">
   insert_cylinder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/insert_sphere.html">
   insert_sphere
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/make_contiguous.html">
   make_contiguous
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/norm_to_uniform.html">
   norm_to_uniform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/overlay.html">
   overlay
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/subdivide.html">
   subdivide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/howtos/unpad.html">
   unpad
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/bar.html">
   bar
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/imshow.html">
   imshow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/sem.html">
   sem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/set_mpl_style.html">
   set_mpl_style
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/show_3D.html">
   show_3D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/show_mesh.html">
   show_mesh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/show_planes.html">
   show_planes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/howtos/xray.html">
   xray
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Generate-test-image">
   Generate test image
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Apply-IBIP-to-image">
   Apply IBIP to image
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Do-some-post-processing">
   Do some post-processing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Run-standard-MIO-for-comparison:">
   Run standard MIO for comparison:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Compare-MIO-and-IBIP-at-Equal-Saturations">
   Compare MIO and IBIP at Equal Saturations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Comparing-Capillary-Pressure-Curves">
   Comparing Capillary Pressure Curves
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Compare-results-with-trapping">
   Compare results with trapping
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Make-a-movie-of-the-invasion">
   Make a movie of the invasion
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 0;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Image-based-invasion-percoalation">
<h1>Image-based invasion percoalation<a class="headerlink" href="#Image-based-invasion-percoalation" title="Permalink to this headline">¶</a></h1>
<p>This notebook illustrates the use of the image-based invasion percolation algorithm decribed <a class="reference external" href="https://arxiv.org/abs/2101.03240">here</a>.</p>
<p>Import necessary packages and functions</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">porespy</span> <span class="k">as</span> <span class="nn">ps</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">edt</span> <span class="kn">import</span> <span class="n">edt</span>
<span class="kn">import</span> <span class="nn">imageio</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="n">ps</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">set_mpl_style</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="Generate-test-image">
<h2>Generate test image<a class="headerlink" href="#Generate-test-image" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">blobs</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">porosity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">blobiness</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Also generate an image defining the inlets</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">bd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">bd</span> <span class="o">*=</span> <span class="n">im</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">trim_disconnected_blobs</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">bd</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">edt</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Apply-IBIP-to-image">
<h2>Apply IBIP to image<a class="headerlink" href="#Apply-IBIP-to-image" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inv_seq</span><span class="p">,</span> <span class="n">inv_size</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">ibip</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;morph&#39;</span><span class="p">,</span>
                                    <span class="n">return_sizes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_iters</span><span class="o">=</span><span class="mi">15000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2b1a19dec2d749da8909e1db90a44bc1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

No more accessible invasion sites found...exiting
</pre></div></div>
</div>
</div>
<div class="section" id="Do-some-post-processing">
<h2>Do some post-processing<a class="headerlink" href="#Do-some-post-processing" title="Permalink to this headline">¶</a></h2>
<p>Convert invasion sequence values to saturation, and identify trapped regions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inv_satn</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">seq_to_satn</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">inv_seq</span><span class="p">)</span>
<span class="n">inv_seq_trapping</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">find_trapped_regions</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">inv_seq</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                   <span class="n">return_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inv_satn_trapping</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">seq_to_satn</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">inv_seq_trapping</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
</div>
<div class="section" id="Run-standard-MIO-for-comparison:">
<h2>Run standard MIO for comparison:<a class="headerlink" href="#Run-standard-MIO-for-comparison:" title="Permalink to this headline">¶</a></h2>
<p>Compute the MIO result, convert to sequation and saturation using the functions in <code class="docutils literal notranslate"><span class="pre">porespy.tools</span></code>, and also find trapped regions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mio</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">porosimetry</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;mio&#39;</span><span class="p">)</span>
<span class="n">mio_seq</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">size_to_seq</span><span class="p">(</span><span class="n">mio</span><span class="p">)</span>
<span class="n">mio_seq</span><span class="p">[</span><span class="n">im</span><span class="o">*</span><span class="p">(</span><span class="n">mio_seq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Adjust to set uninvaded to -1</span>
<span class="n">mio_satn</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">seq_to_satn</span><span class="p">(</span><span class="n">mio_seq</span><span class="p">)</span>
<span class="n">mio_seq_trapping</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">find_trapped_regions</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">mio_seq</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                   <span class="n">return_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Comparing the invasion configurations between the MIO and IBIP algorithms below suggests that the methods produce similar results when trapping is turned off. In fact, it can be shown that the MIO result is a subset of the IBIP result.</p>
</div>
<div class="section" id="Compare-MIO-and-IBIP-at-Equal-Saturations">
<h2>Compare MIO and IBIP at Equal Saturations<a class="headerlink" href="#Compare-MIO-and-IBIP-at-Equal-Saturations" title="Permalink to this headline">¶</a></h2>
<p>The comparison between the two methods can only be done when trapping is neglected. The difference in the trapped defending phase from each method is discussed further below.</p>
<p>The images below show the saturation fields for both IBIP and MIO.</p>
<blockquote>
<div><p>Saturation field means that each voxel in the image contains the value of the saturation at the point is was invaded. In other words, the operation <code class="docutils literal notranslate"><span class="pre">satn</span> <span class="pre">&lt;=</span> <span class="pre">s</span></code> will yeild and image containing the fluid configuration at saturation equal to <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inv_satn</span><span class="o">/</span><span class="n">im</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mio_satn</span><span class="o">/</span><span class="n">im</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_filters_tutorials_using_ibip_15_0.svg" src="../../../_images/examples_filters_tutorials_using_ibip_15_0.svg" /></div>
</div>
<p>The saturation fields can be compared directly by seeing which voxels are filled at each saturation in both methods. We must first find all the values of saturation that were obtained in the MIO result, which consists of discrete jumps (i.e. from <code class="docutils literal notranslate"><span class="pre">s=0.33</span></code> to <code class="docutils literal notranslate"><span class="pre">s=0.49</span></code>) due to the pressure based nature of the simulations. Once we have a list of all unique saturation values, we can threshold the saturation fields from both simulations at these values and compare the configurations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inv_satn_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">inv_satn</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mio_satn_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">mio_satn</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">satns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mio_satn_t</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">err</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">satns</span><span class="p">:</span>
    <span class="n">ip_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">inv_satn_t</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">inv_satn_t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mio_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">mio_satn_t</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">mio_satn_t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">diff</span><span class="p">[(</span><span class="n">mio_mask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ip_mask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">im</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">diff</span><span class="p">[(</span><span class="n">mio_mask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ip_mask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">im</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">err</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">mio_mask</span> <span class="o">!=</span> <span class="n">ip_mask</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>In the figure below we plot the differences between the two results at equal saturation. On the left is the fluid configurations of each method overlaid on top of each other. Any voxels that are not green indicate locations where the two results disagree. There are very few of them and almost impossible to see (e.g. near [x, y]=[250, 50]), so the plot on the right shows the count of mis-matching voxels as a function of saturation. The total count never exceeds 70, which is a very small fraction
of a 500 x 500 image. The differences are due to the numerical precision of the saturation values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diff</span><span class="o">/</span><span class="n">im</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">satns</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_filters_tutorials_using_ibip_19_0.svg" src="../../../_images/examples_filters_tutorials_using_ibip_19_0.svg" /></div>
</div>
</div>
<div class="section" id="Comparing-Capillary-Pressure-Curves">
<h2>Comparing Capillary Pressure Curves<a class="headerlink" href="#Comparing-Capillary-Pressure-Curves" title="Permalink to this headline">¶</a></h2>
<p>Converting the invasion configurations to capillary pressure curves is possible using functions provided in the <code class="docutils literal notranslate"><span class="pre">metrics</span></code> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pc_curve_from_ibip</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="n">inv_seq</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">inv_size</span><span class="p">,</span> <span class="n">voxel_size</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">);</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pc_curve_from_mio</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">mio</span><span class="p">,</span> <span class="n">voxel_size</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">stepped</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pc</span><span class="p">),</span> <span class="n">d</span><span class="o">.</span><span class="n">snwp</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IBIP&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">pc</span><span class="p">),</span> <span class="n">e</span><span class="o">.</span><span class="n">snwp</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MIO&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Capillary Pressure [Pa]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Non-wetting Phase Saturation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_filters_tutorials_using_ibip_22_0.svg" src="../../../_images/examples_filters_tutorials_using_ibip_22_0.svg" /></div>
</div>
<p>The above capillary pressure curves are quite interesting. The MIO curve in red is the envelop of peak pressures obtained by the IPIP curve in green.</p>
<p>The red line corresponds to the normal ‘porosimetry’ experiment where increasingly high pressures are applied (x-axis) and larger fractions of the void space are filled (y-axis). Each verticle jump in the red curve corresponds to a new region of the image being penetrated because the breakthrough pressure of a constriction was exceed. All the void space beyond this constriction is then filled at once.</p>
<p>The green line is the result of IBIP and corresponds to volume controlled injection, where fluid is injected at some constant rate. Every data point has a slightly higher saturation than the previous so there are no plateaus of constant saturation. However, the capillary pressure (x-axis) fluctuates up and down seemlingly randomly. This is because the advancing menisci squeeze through small constrictions (higher pressure), then enter into a larger region that was sheilded by the constriction to
they expand (lower pressure). This process repeats itself through the entire simulation.</p>
</div>
<div class="section" id="Compare-results-with-trapping">
<h2>Compare results with trapping<a class="headerlink" href="#Compare-results-with-trapping" title="Permalink to this headline">¶</a></h2>
<p>One of the key benefits of the IBIP algorithm is that the fluid invades incrememtally instead of in steps. This means the appearance of trapped defending phase is immediately noted. By contrast, the MIO approach computes large changes in saturation, so any trapping that may occur between these large jumps is not resolved. Therefore, only the IBIP method can correctly identify trapped defending phase. This is illustrated below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">turbo</span><span class="p">)</span>
<span class="n">cmap</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">cmap</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">inv_seq_trapping</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">im</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">mio_seq_trapping</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">im</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">mio_seq_trapping</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mf">2.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">inv_seq_trapping</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">temp</span><span class="o">/</span><span class="n">im</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_filters_tutorials_using_ibip_25_0.svg" src="../../../_images/examples_filters_tutorials_using_ibip_25_0.svg" /></div>
</div>
<p>The red color in the right image indicates regions that were invaded by the MIO algorithm, but not by the IBIP algorithm. The MIO will always underestimate trapping.</p>
</div>
<div class="section" id="Make-a-movie-of-the-invasion">
<h2>Make a movie of the invasion<a class="headerlink" href="#Make-a-movie-of-the-invasion" title="Permalink to this headline">¶</a></h2>
<p>The image below is a sample of the animated output:</p>
<img alt="https://cdn.substack.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ffdfb8881-2e28-410f-a36b-e0bcb906629b_500x501.gif" src="https://cdn.substack.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ffdfb8881-2e28-410f-a36b-e0bcb906629b_500x501.gif" />
<p>Obtaining a movie such as the one above can be accomplished with something like the following, which creates an interactive widget in a jupyter notebook.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;animation.html&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;jshtml&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;animation.embed_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">mov</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">satn_to_movie</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">satn</span><span class="o">=</span><span class="n">inv_satn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021 PoreSpy Team.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>